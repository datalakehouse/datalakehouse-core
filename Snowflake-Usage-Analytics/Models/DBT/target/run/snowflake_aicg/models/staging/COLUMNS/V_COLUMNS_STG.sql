
  create or replace  view DEVELOPER_SANDBOX.DBT_SNOWFLAKE_USAGE.V_COLUMNS_STG  as (
    
 

WITH source AS (
  SELECT * FROM  SNOWFLAKE.ACCOUNT_USAGE."COLUMNS"
),

rename as (
SELECT
--DLHK
  MD5(S.COLUMN_ID) AS K_COLUMN_DLHK
  ,MD5(S.TABLE_ID) AS K_TABLE_DLHK
  ,MD5(S.TABLE_CATALOG_ID) AS K_DATABASE_DLHK
  ,MD5(CONCAT(COALESCE(S.TABLE_NAME,'A'),COALESCE(S.TABLE_SCHEMA_ID,0),COALESCE(S.TABLE_CATALOG_ID,0))) AS K_UNIQUE_TABLE_DLHK
--BUSINESS KEYS
  ,S.COLUMN_ID AS K_COLUMN_BK
  ,S.TABLE_ID AS K_TABLE_BK
  ,S.TABLE_CATALOG_ID AS K_DATABASE_BK
  ,S.TABLE_SCHEMA_ID AS K_TABLE_SCHEMA_BK
  --ATTRIBUTES  
  ,S.CHARACTER_SET_CATALOG AS A_CHARACTER_SET_CATALOG
  ,S.CHARACTER_SET_NAME AS A_CHARACTER_SET_NAME
  ,S.CHARACTER_SET_SCHEMA AS A_CHARACTER_SET_SCHEMA
  ,S.COLLATION_CATALOG AS A_COLLATION_CATALOG
  ,S.COLLATION_NAME AS A_COLLATION_NAME
  ,S.COLLATION_SCHEMA AS A_COLLATION_SCHEMA
  ,S.COLUMN_DEFAULT AS A_COLUMN_DEFAULT
  ,S.COLUMN_NAME AS A_COLUMN_NAME
  ,S.COMMENT AS A_COMMENT
  ,S.DATA_TYPE AS A_DATA_TYPE
  ,S.DELETED AS A_DELETED
  ,S.DOMAIN_CATALOG AS A_DOMAIN_CATALOG
  ,S.DOMAIN_NAME AS A_DOMAIN_NAME
  ,S.DOMAIN_SCHEMA AS A_DOMAIN_SCHEMA
  ,S.INTERVAL_PRECISION AS A_INTERVAL_PRECISION
  ,S.INTERVAL_TYPE AS A_INTERVAL_TYPE
  ,S.MAXIMUM_CARDINALITY AS A_MAXIMUM_CARDINALITY
  ,S.SCOPE_CATALOG AS A_SCOPE_CATALOG
  ,S.SCOPE_NAME AS A_SCOPE_NAME
  ,S.SCOPE_SCHEMA AS A_SCOPE_SCHEMA
  ,S.TABLE_CATALOG AS A_TABLE_CATALOG
  ,S.TABLE_NAME AS A_TABLE_NAME
  ,S.TABLE_SCHEMA AS A_TABLE_SCHEMA
  ,S.UDT_CATALOG AS A_UDT_CATALOG
  ,S.UDT_NAME AS A_UDT_NAME
  ,S.UDT_SCHEMA AS A_UDT_SCHEMA
  ,S.DTD_IDENTIFIER AS A_DTD_BKENTIFIER
  ,S.IDENTITY_CYCLE AS A_IDENTITY_CYCLE
  ,S.IDENTITY_GENERATION AS A_IDENTITY_GENERATION
  ,S.IDENTITY_INCREMENT AS A_IDENTITY_INCREMENT
  ,S.IDENTITY_MAXIMUM AS A_IDENTITY_MAXIMUM
  ,S.IDENTITY_MINIMUM AS A_IDENTITY_MINIMUM
  ,S.IDENTITY_START AS A_IDENTITY_START
  --BOOLEAN
  ,S.IS_IDENTITY='YES' AS B_IS_BKENTITY
  ,S.IS_NULLABLE='YES' AS A_IS_NULLABLE
  ,S.IS_SELF_REFERENCING='YES' AS A_IS_SELF_REFERENCING
  --METRICS
  ,S.CHARACTER_MAXIMUM_LENGTH AS M_CHARACTER_MAXIMUM_LENGTH
  ,S.CHARACTER_OCTET_LENGTH AS M_CHARACTER_OCTET_LENGTH
  ,S.DATETIME_PRECISION AS M_DATETIME_PRECISION
  ,S.NUMERIC_PRECISION AS M_NUMERIC_PRECISION
  ,S.NUMERIC_PRECISION_RADIX AS M_NUMERIC_PRECISION_RADIX
  ,S.NUMERIC_SCALE AS M_NUMERIC_SCALE
  ,S.ORDINAL_POSITION AS M_ORDINAL_POSITION
    --metadata (MD)  
  ,S.DELETED AS MD_VALID_TO_DTS
  ,S.DELETED IS NOT NULL AS MD_IS_DELETED
  , CURRENT_TIMESTAMP AS MD_ELT_UPDATED_DTS        
  , '5d46a0f0-b3d3-4524-9663-160a0476382b' AS MD_INTGR_ID
FROM
    source S
)

SELECT * FROM rename
  );
