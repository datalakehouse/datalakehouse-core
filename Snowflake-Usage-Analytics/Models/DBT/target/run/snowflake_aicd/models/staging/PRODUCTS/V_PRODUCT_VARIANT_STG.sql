
  create or replace  view DEVELOPER_SANDBOX.DBT_SHOPIFY.V_PRODUCT_VARIANT_STG  as (
    
 

WITH source AS (
  SELECT * FROM  DEVELOPER_SANDBOX.DEMO_SHOPIFY."PRODUCT_VARIANT"
),

rename as (


SELECT
  MD5(ID) AS K_PRODUCT_VARIANT_DLHK
  ,MD5(PRODUCT_ID) AS K_PRODUCT_DLHK  
  --BUSINESS KEYS  
  ,ID AS K_PRODUCT_VARIANT_BK
  ,PRODUCT_ID AS K_PRODUCT_BK  
  ,INVENTORY_ITEM_ID AS K_INVENTORY_ITEM_BK
  ,IMAGE_ID AS K_IMAGE_BK
  --ATTRIBUTES
  ,TITLE AS A_TITLE  
  ,SKU AS A_SKU    
  ,FULFILLMENT_SERVICE AS A_FULFILLMENT_SERVICE
  ,INVENTORY_MANAGEMENT AS A_INVENTORY_MANAGEMENT
  ,INVENTORY_POLICY AS A_INVENTORY_POLICY
  ,BARCODE AS A_BARCODE
  ,GRAMS AS A_GRAMS
  ,WEIGHT_UNIT AS A_WEIGHT_UNIT
  ,OPTION_1 AS A_OPTION_1
  ,OPTION_2 AS A_OPTION_2
  ,OPTION_3 AS A_OPTION_3
  ,TAX_CODE AS A_TAX_CODE  
  ,PRESENTMENT_PRICES AS A_PRESENTMENT_PRICES  
  ,CREATED_AT AS A_CREATED_AT_DTS
  ,UPDATED_AT AS A_UPDATED_AT_DTS
  --BOOLEAN
  ,REQUIRES_SHIPPING AS B_REQUIRES_SHIPPING
  ,TAXABLE AS B_TAXABLE
  --METRICS
  ,PRICE AS M_PRICE
  ,POSITION AS M_POSITION
  ,COMPARE_AT_PRICE AS M_COMPARE_AT_PRICE
  ,INVENTORY_QUANTITY AS M_INVENTORY_QUANTITY
  ,INVENTORY_QUANTITY_ADJUSTMENT AS M_INVENTORY_QUANTITY_ADJUSTMENT
  ,WEIGHT AS M_WEIGHT
  --metadata (MD)
  ,__DLH_IS_DELETED AS MD_IS_DELETED
  , CURRENT_TIMESTAMP AS MD_ELT_UPDATED_DTS        
  , 'cc5603df-43e1-42fa-bf2e-6c12e9f40242' AS MD_INTGR_ID
FROM
    source
)

SELECT * FROM rename
  );
