
 

WITH source AS (
  SELECT * FROM  DEVELOPER_SANDBOX.DEMO_SHOPIFY."PRODUCT"
),

rename as (


SELECT
  MD5(ID) AS K_PRODUCT_DLHK
  ,ID AS K_PRODUCT_BK
  --ATTRIBUTES
  ,TITLE AS A_TITLE
  ,HANDLE AS A_HANDLE
  ,PRODUCT_TYPE AS A_PRODUCT_TYPE
  ,VENDOR AS A_VENDOR
  ,CREATED_AT AS A_CREATED_AT_DTS
  ,UPDATED_AT AS A_UPDATED_AT_DTS
  ,PUBLISHED_AT AS A_PUBLISHED_AT_DTS
  ,PUBLISHED_SCOPE AS A_PUBLISHED_SCOPE
  ,STATUS AS A_STATUS
  ,TEMPLATE_SUFFIX AS A_TEMPLATE_SUFFIX   
  --metadata (MD)
  ,__DLH_IS_DELETED AS MD_IS_DELETED
  , CURRENT_TIMESTAMP AS MD_ELT_UPDATED_DTS        
  , 'cc5603df-43e1-42fa-bf2e-6c12e9f40242' AS MD_INTGR_ID
FROM
    source
)

SELECT * FROM rename