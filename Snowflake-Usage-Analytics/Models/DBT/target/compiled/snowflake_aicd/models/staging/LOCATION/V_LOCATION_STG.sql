
 

WITH source AS (
  SELECT * FROM  DEVELOPER_SANDBOX.DEMO_SHOPIFY."LOCATION"
),

rename as (
  SELECT
  MD5(ID) AS K_LOCATION_DLHK
  ,ID AS K_LOCATION_BK
  ,ADDRESS_1 AS A_ADDRESS_1
  ,ADDRESS_2 AS A_ADDRESS_2
  ,CITY AS A_CITY
  ,COUNTRY AS A_COUNTRY
  ,COUNTRY_CODE AS A_COUNTRY_CODE
  ,COUNTRY_NAME AS A_COUNTRY_NAME
  ,CREATED_AT AS A_CREATED_AT
  ,LOCALIZED_COUNTRY_NAME AS A_LOCALIZED_COUNTRY_NAME
  ,LOCALIZED_PROVINCE_NAME AS A_LOCALIZED_PROVINCE_NAME
  ,NAME AS A_NAME
  ,PHONE AS A_PHONE
  ,PROVINCE AS A_PROVINCE
  ,PROVINCE_CODE AS A_PROVINCE_CODE
  ,UPDATED_AT AS A_UPDATED_AT_DTS
  ,ZIP AS A_ZIP
  --BOOLEAN  
  ,ACTIVE AS B_ACTIVE
  ,LEGACY AS B_LEGACY   
  --metadata (MD)
  ,__DLH_IS_DELETED AS MD_IS_DELETED
  , CURRENT_TIMESTAMP AS MD_ELT_UPDATED_DTS        
  , '9a6254a5-a7b6-4785-afcf-f956626fae6f' AS MD_INTGR_ID
FROM
    source
)

SELECT * FROM rename